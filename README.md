# orm4GS: ORM для Google Sheets


**Object‑Relational Mapping (ORM, «объектно‑реляционное отображение»)** — программная технология, создающая «мост» между объектно‑ориентированными языками программирования и реляционными базами данных. Она преобразует данные между двумя принципиально разными парадигмами.


## Основные принципы ORM

* **Абстракция.** ORM предоставляет высокоуровневую абстракцию базы данных — программистам не нужно вникать в детали SQL СУБД, можно сосредоточиться на бизнес‑логике.
* **Независимость от базы данных.** ORM позволяет взаимодействовать с разными базами данных без изменения кода приложения. Общий набор команд автоматически переводится в конкретный SQL для выбранной БД.
* **Объектная модель.** Строки в таблицах БД представляются как объекты в коде — это сближает модели данных приложения с его объектно‑ориентированной структурой.
* **Доступ к данным.** ORM упрощает выполнение CRUD‑операций с объектами в коде: система автоматически преобразует их в SQL‑запросы.


## Особенности реализации orm4GS

В этой реализации задача упрощена: создана возможность в коде Google Apps Script (GAS) обращаться к столбцам, строкам и ячейкам **вне зависимости от их расположения на листе**.

**GAS‑ORM (Google Apps Script ORM)** — легковесная ORM‑реализация для Google Sheets. Позволяет работать с данными через названия столбцов, а не их индексы.

### Преимущества

* **Именованный доступ.** Обращайтесь к данным через `row.phonenamber`, а не `row[5]`.
* **Гибкость.** Изменение порядка столбцов в таблице не требует правок в коде.
* **Универсальная инициализация.** Поддержка передачи параметров как списком, так и объектом.

## Пример таблицы

| Guide_Main | PhoneNamber | UNIQ | Cod | Plot | FIO | Command | Registered | Who | Check | Del | Hash | Комментарий |
|----------|------------|------|-----|------|-----|---------|------------|-----|-------|-----|------|-------------|
| +79111111111 | 1 | 1 | — | Иванов Иван Иванович | ADD,111,1=79111111111 | 1 | 70945140d5446edc9818a63b53927495 | — | — | — | — | — |
| +79111111111 | 2 | 2 | — | Иванов Иван Иванович | ADD,111,2=79111111111 | 1 | f52c7f959a0a275b402d5dda7e45cadc | — | — | — | — | — |
| +79111111111 | 5 | 3 | — | Иванов Иван Иванович | ADD,111,3=79111111111 | 1 | fdc4ce4d3113e656c9b51dcab30600f8 | — | — | — | — | — |
| +79111111111 | 9 | 4 | — | Иванов Иван Иванович | ADD,111,4=79111111111 | 1 | 7b93bac32a83723e9158e2931d20bc1c | — | — | — | — | — |
| +79111111111 | 11 | 5 | — | Иванов Иван Иванович | ADD,111,5=79111111111 | 1 | c14b35f5c11c1a657722bbc955b70529 | — | — | — | — | — |


*(Полный набор строк опущен для краткости)*

## Установка

1. Скопируйте файлы библиотеки в свой проект Google Apps Script.
2. Убедитесь, что у скрипта есть доступ к Google Sheets (разрешения запрашиваются при первом запуске).

## Инициализация

Инициализируйте экземпляр ORM:

**Передача аргументов списком:**

```javascript
const _book = SpreadsheetApp.openById('ID_ТАБЛИЦЫ');
const sheet = _book.getSheetByName('Arhiv');
const orm = init(sheet, 2); // 2 — количество строк заголовка
