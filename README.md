# orm4GS: ORM для Google Sheets
Примеры кода:
Прелесть, когда работать надо с таблицей - справочником.
Тогда запись и чтение данных БД плосков в таблице выглядит так:
```javascript
  isInBD(number) {
    const res = this.orm.guide_main.phonenumber.find(number);
    console.log(number);
    console.log(res?.plot);
    return { f: res ? true : false, plot: res?.plot, fio: res?.fio };
  }
  updateBD(number,fio) {
    const res = this.orm.guide_main.phonenumber.find(number);
    res.fio = fio;
    return { f: res ? true : false };
  }
```
Это код для примера в таблице ниже.
Немного больше подробностей в файле Help.md
Весь код библиотеки полностью рабочий, использую его во многих своих проектах.
Но его нужно дотачивать: делать проверки и защиты на контроль данных, что бы не падал.
Руки не доходят.....

## Вот еще один пример
```javascript
function test_addNewUser() {
  const _wrk = new Worker(undefined, undefined);
  const newData = {
    fio: `Петя_${_wrk.getFreeCod()}`,
    cod: _wrk.getFreeCod(),
    plot: '11',
    phonenumber: 79112223300+_wrk.getFreeCod(),
  };
  _wrk.orm.guide_main.getFreeRow().setValues(newData);

  const ormRow_by_phone = _wrk.orm.guide_main.phonenumber.find(newData.phonenumber);
  ormRow_by_phone.who='Добавим кто';
  ormRow_by_phone.command='Добавим команду';
  const _hash = ormRow_by_phone.hash;
  if(_hash == '') ormRow_by_phone.hash='sgsty66ADS76SADA'
}
```
Самая прелесть в последних 5 строках!!!



Справочно:
**Object‑Relational Mapping (ORM, «объектно‑реляционное отображение»)** — программная технология, создающая «мост» между объектно‑ориентированными языками программирования и реляционными базами данных. Она преобразует данные между двумя принципиально разными парадигмами.


## Основные принципы ORM

* **Абстракция.** ORM предоставляет высокоуровневую абстракцию базы данных — программистам не нужно вникать в детали SQL СУБД, можно сосредоточиться на бизнес‑логике.
* **Независимость от базы данных.** ORM позволяет взаимодействовать с разными базами данных без изменения кода приложения. Общий набор команд автоматически переводится в конкретный SQL для выбранной БД.
* **Объектная модель.** Строки в таблицах БД представляются как объекты в коде — это сближает модели данных приложения с его объектно‑ориентированной структурой.
* **Доступ к данным.** ORM упрощает выполнение CRUD‑операций с объектами в коде: система автоматически преобразует их в SQL‑запросы.


## Особенности реализации orm4GS

В этой реализации задача упрощена: создана возможность в коде Google Apps Script (GAS) обращаться к столбцам, строкам и ячейкам **вне зависимости от их расположения на листе**.

**GAS‑ORM (Google Apps Script ORM)** — легковесная ORM‑реализация для Google Sheets. Позволяет работать с данными через названия столбцов, а не их индексы.

### Преимущества

* **Именованный доступ.** Обращайтесь к данным через `row.phonenumber`, а не `row[5]`.
* **Гибкость.** Изменение порядка столбцов в таблице не требует правок в коде.
* **Универсальная инициализация.** Поддержка передачи параметров как списком, так и объектом.

## Пример таблицы
| Guide_Main   | | | | | | | | | | |
|--------------|-----|-----|-----------------------|-----------|---|----------------------------------|-----|-------|-----|-------------|
| PhoneNumber  | Cod | Plot| FIO                   | Command   |Reg| Hash                             | Who | Check | Del | Комментарий |
| +79111111111 | 1 | 1     | Иванов1 Иван Иванович | ADD,111,1 | 1 | 70945140d5446edc9818a63b53927495 | —   | —     | —   | —           |
| +79111111111 | 2 | 2     | Иванов2 Иван Иванович | ADD,111,2 | 1 | f52c7f959a0a275b402d5dda7e45cadc | —   | —     | —   | —           |
| +79111111111 | 5 | 3     | Иванов3 Иван Иванович | ADD,111,3 | 1 | fdc4ce4d3113e656c9b51dcab30600f8 | —   | —     | —   | —           |


*(Полный набор строк опущен для краткости)*

## Установка

1. Скопируйте файлы библиотеки в свой проект Google Apps Script.
2. Убедитесь, что у скрипта есть доступ к Google Sheets (разрешения запрашиваются при первом запуске).

## Инициализация

Инициализируйте экземпляр ORM:

**Передача аргументов списком:**

```javascript
const _book = SpreadsheetApp.openById('ID_ТАБЛИЦЫ');
const sheet = _book.getSheetByName('Arhiv');
const orm = init(sheet, 2); // 2 — количество строк заголовка
