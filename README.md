# orm4GS
Object-Relational Mapping («объектно-реляционное отображение»)

Программная технология, которая создаёт «мост» между объектно-ориентированными языками программирования и реляционными базами данных, преобразуя данные между двумя принципиально разными парадигмами.

Некоторые основные принципы ORM:
- Абстракция. ORM предоставляет высокоуровневую абстракцию базы данных, что позволяет программистам не задумываться о конкретных деталях SQL СУБД и сосредоточиться на бизнес-логике.
- Независимость от базы данных. ORM часто предоставляет способ взаимодействовать с различными базами данных без необходимости изменять код приложения. Это достигается за счёт использования общего набора команд, которые затем переводятся в конкретный SQL автоматически для выбранной базы данных.
- Объектная модель. Основная идея ORM состоит в том, чтобы сделать модели данных приложения ближе к его объектно-ориентированной структуре. Это означает, что строки в таблицах базы данных представлены как объекты в программном коде.
- Доступ к данным. С помощью ORM можно легко выполнять CRUD-операции с объектами в коде, а система ORM будет автоматически преобразовывать эти операции в соответствующие SQL-запросы.

В данной реализации все проще.
 Сделал возможность в коде gs обращатся к столбцам/строкам/ячейкам вне зависимости от их расположения на листе.

Пример таблицы "example of tables.png":
Guide_Main												
PhoneNamber	UNIQ	Cod	Plot	-	FIO	Command	Registered	Who	Check	Del	Hash	Комментарий
+79111111111		1	1		Иванов Иван Иванович	ADD,111,1=79111111111			1		70945140d5446edc9818a63b53927495	
+79111111111		2	2		Иванов Иван Иванович	ADD,111,2=79111111111			1		f52c7f959a0a275b402d5dda7e45cadc	
+79111111111		5	3		Иванов Иван Иванович	ADD,111,3=79111111111			1		fdc4ce4d3113e656c9b51dcab30600f8	
+79111111111		9	4		Иванов Иван Иванович	ADD,111,4=79111111111			1		7b93bac32a83723e9158e2931d20bc1c	
+79111111111		11	5		Иванов Иван Иванович	ADD,111,5=79111111111			1		c14b35f5c11c1a657722bbc955b70529	
+79111111111		12	6		Иванов Иван Иванович	ADD,111,6=79111111111			1		c81056a8388f8cac9cb901063120d16f	
+79111111111		13	7		Иванов Иван Иванович	ADD,111,7=79111111111			1		876ed4291fb95d494efecf457d4c048d	
+79111111111		14	8		Иванов Иван Иванович	ADD,111,8=79111111111			1		701099192c6b29e4a72c03c9ae981a66	
+79111111111		15	9		Иванов Иван Иванович	ADD,111,9=79111111111			1		f3ae7bdb47c0f5c8f433be59610a3348	
+79111111111		16	10		Иванов Иван Иванович	ADD,111,10=79111111111			1		896a0dee43262978db425880ba50d7e3	
+79111111111		19	11		Иванов Иван Иванович	ADD,111,11=79111111111			1		1112ebf893a1b840c5f9de207309fea6

example of tables.png

GAS-ORM (Google Apps Script ORM)
Легковесная ORM-реализация для Google Sheets, которая позволяет работать с данными через названия столбцов, а не их индексы. Это отвязывает логику скрипта от физического расположения колонок: вы можете перемещать столбцы в таблице, и ваш код не сломается.
Основные преимущества
Именованный доступ: Обращайтесь к данным через row.phonenamber, а не row[5].
Гибкость: Изменение порядка столбцов в таблице не требует правок в коде.
Универсальная инициализация: Поддержка передачи параметров как списком, так и объектом.
Установка
Скопируйте файлы библиотеки в свой проект Google Apps Script.
Инициализация
Инициализировать экземпляр ORM:
1. Передача аргументов списком
javascript
const _book = SpreadsheetApp.openById('ID_ТАБЛИЦЫ');
const sheet = _book.getSheetByName('Arhiv');
const orm = init(sheet, 2); // 2 — количество строк заголовка


Примеры использования
Поиск и получение данных
Забудьте о getRange(row, col). Используйте методы поиска по именованным полям:
javascript
isInBD(number) {
  // Находим запись в колонке 'phonenumber'
  const res = this.orm.guide_main.phonenumber.find(number, false);
  
  console.log('Искомый номер:', number);
  console.log('Участок (plot):', res?.plot);

  return { 
    exists: !!res, 
    plot: res?.plot, 
    fio: res?.fio 
  };
}

Принцип именования
ORM автоматически сопоставляет заголовки первой (или второй, как в примере) строки с именами свойств объекта (с переводом в нижний регистр). Рекомендуется использовать латиницу без пробелов в заголовках таблицы для прямого обращения через точку.
API функции init
javascript
/**
 * Инициализирует ORM для работы с таблицей.
 * @param {GoogleAppsScript.Spreadsheet.Sheet|Object} shOrOptions - Лист или объект с параметрами.
 * @param {number} [nHeaderLines=2] - Кол-во строк заголовка.
 * @returns {Sheet} Экземпляр класса Sheet для работы с данными.
 */

Разработано для повышения стабильности и упрощения автоматизаций в Google Sheets.

